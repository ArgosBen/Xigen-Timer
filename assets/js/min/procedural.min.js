$(function(){"use strict";var e,t=$(".login [type=submit]");$(document).foundation(),$("[data-logout]").on("click",function(e){e.preventDefault(),localforage.setItem("authToken",null),localforage.setItem("userName",null),localforage.setItem("baseURL",null),XIGENTIMER.reset(),XIGENTIMER.VIEWMODEL.reset(!0)}),$("[data-login]").on("submit",function(n){n.preventDefault();var o,a=$("[name=password]",this).val(),i=$("[name=user]",this).val(),c=$("[name=baseURL]",this).val();e=t.text(),t.text("Logging in..."),localforage.setItem("baseURL",c).then(XIGENTIMER.authoriseUser(i,a,function(n){n?(t.text(e),localforage.setItem("userToken",o),localforage.setItem("userName",n),localforage.setItem("baseURL",c),XIGENTIMER.VIEWMODEL.isLoggedIn(!0),XIGENTIMER.drawProjects()):t.text("Incorrect login, try again :)")}))}),localforage.getItem("userToken",function(e){e&&XIGENTIMER.authoriseUser(function(){XIGENTIMER.VIEWMODEL.isLoggedIn(!0),XIGENTIMER.drawProjects()})}),$(".do-reset").on("click",function(){XIGENTIMER.reset()}),$(".do-viewonline").on("click",function(){localforage.getItem("baseURL",function(e){e=e.replace("/rest/v1/",""),XIGENTIMER.launchExternal(e+"/TaskDetails.aspx?ID="+XIGENTIMER.VIEWMODEL.selectedProject())})}),$("body").on("click","a",function(e){"_system"===$(this).attr("target")&&(e.preventDefault(),XIGENTIMER.launchExternal($(this).attr("href")))}),$(".time-table").on("click",".button",function(){XIGENTIMER.editTimeLog($(this).parents("tr").attr("data-id"),this)}),$(".icon-min").on("click",function(){XIGENTIMER.minimize()}),$(".icon-hide").on("click",function(){XIGENTIMER.goToTray()}),$(".icon-close").on("click",function(){XIGENTIMER.close()})});