$(function(){"use strict";function e(e,l){console.log("Authorizing (level 1) with "+e),console.log("Authorizing (level 1) with user "+l),XIGENTIMER.API.authorizeUser(e,l,function(e){e?(localforage.setItem("user",e),$("[data-avatar]").find("img").remove(),$("[data-avatar]").prepend("<img src='"+i+"&h="+e.AvatarHash+"&id="+e.UserID+"'/>"),t(),n.isLoggedOut(!1),n.isLoggedIn(!0)):(o.text("Incorrect login, try again! :)").addClass("warning").removeClass("info"),setTimeout(function(){o.text(a).addClass("info").removeClass("warning")},3e3))})}function t(){XIGENTIMER.API.getProjects(function(e){var t,a,o=$(".side-nav"),n=document.createDocumentFragment();o.empty(),$.each(e,function(e,o){t=$(document.createElement("li")),t.text(o.Name),o.Activities&&o.Activities.length>0&&(a=$(document.createElement("ul")),$.each(o.Activities,function(e,t){console.log(t),a.append("<li><a href='#'>"+t.Name+"</a></li>")}),t.append(a)),n.appendChild(t[0])}),o[0].appendChild(n)})}{var a,o,n,i="http://projects.xigen.co.uk/ImagePage.aspx?t=0";$(".timer").FlipClock({autoStart:!1})}$(document).foundation(),XIGENTIMER.loginForm=function(){this.isLoggedIn=ko.observable(!1),this.isLoggedOut=ko.observable(!0),localforage.getItem("authToken",function(t){t&&localforage.getItem("userName",function(a){a&&t&&e(t,a)})}),$("[data-login]").on("submit",function(t){t.preventDefault();var n,i=$("[name=password]",this).val(),l=$("[name=user]",this).val();o=$("[type=submit]",this),a=o.text(),n="Basic "+new Buffer(l+":"+i).toString("base64"),localforage.setItem("authToken",n),localforage.setItem("userName",l),o.text("Logging in..."),e(n,l)}),$("[data-logout]").on("click",function(e){e.preventDefault(),localforage.setItem("authToken",null),localforage.setItem("userName",null),$("[data-login]")[0].reset(),n.isLoggedOut(!0),n.isLoggedIn(!1)})},n=new XIGENTIMER.loginForm,ko.applyBindings(n)});