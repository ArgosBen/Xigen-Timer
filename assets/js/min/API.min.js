"object"!=typeof XIGENTIMER&&(XIGENTIMER={}),function(t){"use strict";var e=require("node-rest-client").Client,o="http://projects.xigen.co.uk/rest/v1/",n=new e,i={userID:0,email:"matt@xigen.co.uk"};t.API={authorizeUser:function(t,e,i){console.log("Authorizing (level 2) with "+t),console.log("Authorizing (level 2) with user "+e);var r=!1;n.get(o+"users",{headers:{Authorization:t,"Content-Type":"application/json"}},function(t){t?($.each(JSON.parse(t),function(t,o){return o.Login.toLowerCase()===e.toLowerCase()?(localforage.setItem("user",o),r=o,!1):void 0}),"function"==typeof i&&i(r)):"function"==typeof i&&i(!1)})},getProjects:function(t){var e,i=0;localforage.getItem("authToken",function(r){n.get(o+"projects",{headers:{Authorization:r,"Content-Type":"application/json"}},function(a){localforage.getItem("user",function(s){var c=a?JSON.parse(a):[],u=c.filter(function(t){return t.Members.split("\n").indexOf(s.Name)>-1});e=u.length,$(u).each(function(a){var s=this;n.get(o+"projects/"+s.ProjectID+"/activities/",{headers:{Authorization:r,"Content-Type":"application/json"}},function(o){u[a].Activities=JSON.parse(o),i+=1,"function"==typeof t&&i===e&&t(u)})})})})})},getActivities:function(){localforage.getItem("authToken",function(t){n.get(o+"activities",{headers:{Authorization:t,"Content-Type":"application/json"}},function(t){console.log(JSON.parse(t))})})},getTimelogs:function(){n.get(o+"timelogs",{headers:{Authorization:"Basic bWF0dG06NmdyZWVuY2F0","Content-Type":"application/json"}},function(t){var e=JSON.parse(t).filter(function(t){return t.UserID===i.userID});$.each(e,function(){$("body").append("<p>"+this.Duration+" hours doing task: "+this.Description+"</p>")})})}}}(XIGENTIMER);