!function(t){"use strict";var e;t.drawTaskList=function(){e()},e=function(){var t,e,a,r,i,o,n;localforage.getItem("activityCache",function(e){t=e,localforage.getItem("baseURL",function(t){n="/"===t.charAt(t.length-1)?t:t+"/",a()})}),a=function(){localforage.getItem("projectCache",function(t){r=t}).then(function(){localforage.getItem("user",function(t){i=t.UserID}).then(e)})},e=function(){t=t.filter(function(t){return t.EndDate&&t.CanEdit&&!t.HasChild&&(18===t.TaskStatusID||1===t.TaskStatusID)}),o()},o=function(){XIGENTIMER.VIEWMODEL.taskList([]),$.each(t,function(t,e){switch(e.PriorityID){case 1:e.PriorityID=4;break;case 2:e.PriorityID=3;break;case 3:e.PriorityID=2;break;case 4:e.PriorityID=1}e.TaskURL=n+"TaskDetails.aspx?ID="+e.TaskID,e.ProjectURL=n+"ProjectDetails.aspx?ID="+e.ProjectID,e.DueDate=moment(e.EndDate,"YYYY-MM-DD/HH:mm:ss.SS").startOf("day").add(17,"h").add(30,"m").fromNow(),e.moment=moment(e.EndDate,"YYYY-MM-DD/HH:mm:ss.SS").startOf("day").add(17,"h").add(30,"m"),e.ProjectName=r.filter(function(t){return t.ProjectID===e.ProjectID})[0].Name}),t=t.sort(function(t,e){return e.PriorityID===t.PriorityID?+e.moment-+t.moment:e.PriorityID-t.PriorityID}),$.each(t,function(){XIGENTIMER.VIEWMODEL.taskList.push(this)})}}}(XIGENTIMER);